# linFFT
Algorithm for automatized detection and analysis of lineament structures from images using Fast Fourier Transform (FFT)

The MATLAB version of this function (linFFT) is part of the electronic supplementary files for

Ruzicka, B.R., Schroeter, M., Pack, A., and Boehnhardt, H.: Detecting and analysing geomorphological structures in images of comet 67P/Churyumov-Gerasimenko

published in the Monthly Notices of the Royal Astronomical Society, Volume 503, Issue 3, Pages 3449-3459, in May 2021 (https://doi.org/10.1093/mnras/stab618)

The entire method, particularly a step-by-step guide for using the function to analyse a larger image, is explained in detail in the article. The function is made available under a Attribution-NonCommercial 4.0 International (CC BY-NC 4.0) license.

Technical requirements:
- linFFT was designed to run on MATLAB R2019b and requires the Image Processing Toolbox and the Signal Processing Toolbox.
- the graphical outputs (figures) generated by the function are designed to be viewed with an undocked, maximised figure-window. For optimal display, the minimum required screen resolution is 1920 x 1080.

To use linFFT for detecting and analysing linear features in an image, run these commands in MATLAB:
>> image = imread('yourfilename.png');
>> linFFT(image);

The function has several input parameters ("settings") which are explained in the function header. The function was designed with defaults for all these settings, but the user will likely need to adjust at least the parameters 'framesize' and 'threshold' according to the input image. Suitable parameters need to be found by trial and error.

The function is able to generate several different figures to visualise the workflow and/or the results. The input parameter 'dispfig' is used to decide which (if any) figure is displayed. 
	dispfig = -1	displays a map of backtransformations along the detected lineaments (cf. Figure 8B)
	dispfig >= 1	displays steps of the workflow (Figure 1) and results (Figures 4 and 5)
	dispfig =  0	no figures are generated

Further notes:
- linFFT is compatible with any image file type that can be read into MATLAB using imread.
- To use linFFT on a single image without dividing it into frames, set 'framesize' == image width. In this case, the input image must be square and image width must end in '01' (e.g. 101, 301, 1201).

Example:
The image "The Wave" used for Figure A1 in the publication is available under creative commons license from
https://commons.wikimedia.org/wiki/File:TheWave_1600pixels.jpg
To reproduce the two panels shown in Figure A1, save the image ("Original file") in the same directory/folder as the linFFT.m script, then open the directory in MATLAB and run these commands:
>> image = imread('TheWave_1600pixels.jpg');
>> linFFT(image);



